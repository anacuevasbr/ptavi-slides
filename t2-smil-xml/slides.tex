%
% $Id: $
%
%
% Compilar a .pdf con LaTeX (pdflatex)
% Es necesario instalar Beamer (paquete latex-beamer en Debian)
%

%
% Gráficos:
% Los gráficos pueden suministrarse en PNG, JPG, TIF, PDF, MPS
% Los EPS deben convertirse a PDF (usar epstopdf)
%

\documentclass{beamer}
\usetheme{GSyC}
%\usepackage[spanish]{babel}
\usepackage[latin1]{inputenc}
\usepackage{graphics}
\usepackage{amssymb} % Simbolos matematicos

%\definecolor{libresoftgreen}{RGB}{162,190,43}
%\definecolor{libresoftblue}{RGB}{0,98,143}

%\setbeamercolor{titlelike}{bg=libresoftgreen}

%% Metadatos del PDF.
\hypersetup{
  pdftitle={Tema 2 - SMIL (y XML)},
  pdfauthor={Gregorio Robles},
  pdfcreator={GSyC, Universidad Rey Juan Carlos},
  pdfproducer=PDFLaTeX,
  pdfsubject={Tema 2 - SMIL (y XML)},
}
%%

\begin{document}

\title{Tema 2 - SMIL (y XML)}
\subtitle{Protocolos para la Transmisión de Audio y Video en Internet}
\institute{grex@gsyc.urjc.es \\
GSyC, Universidad Rey Juan Carlos}
\author{Gregorio Robles}
\date[Oct 2014]{1 de octubre de 2014}

\frame{
\maketitle
}


% Si el titulo o el autor se quieren acortar para los pies de página
% se pueden redefinir aquí:
%\title{Titulo corto}
%\author{Autores abreviado}


%% LICENCIA DE REDISTRIBUCION DE LAS TRANSPAS
\frame{
~
\vspace{4cm}

\begin{flushright}
{\tiny
(cc) 2008-14 Gregorio Robles \\
  Some rights reserved. This work licensed under Creative Commons \\
  Attribution-ShareAlike License. To view a copy of full license, see \\
\ \\
  http://creativecommons.org/licenses/by-sa/3.0/ or write to \\
  Creative Commons, 559 Nathan Abbott Way, Stanford, \\
  California 94305, USA.
}
\end{flushright}
}
%%

\section{El lenguaje de Marcado Extensible (XML)}

\begin{frame}
\frametitle{XML}

\begin{itemize}
\item XML: acrónimo de eXtensible Markup Language.
\item Recomendado por la W3C, es un estándar libre y abierto.
\item Especificación de propósito genereal para crear lenguajes de marcado.
  \begin{itemize}
  \item XHTML, SMIL, SVG, RSS, MathML, GraphML, MusicXML...
  \end{itemize}
\item Uso: Compartición de datos estructurados (especialmente a través de Internet), codificación de documentos y serialización.
\end{itemize}

\end{frame}



\begin{frame}
\frametitle{Estructura de árbol}

\begin{center}
  \includegraphics[width=10.5cm]{figs/xmltree.png}
\end{center}

\begin{flushright}
{\tiny
Source: http://www.cse.unsw.edu.au/~wong/xmltree.gif
}
\end{flushright}

\end{frame}

\begin{frame}
\frametitle{Estructura de árbol (y II): Una página HTML}

\begin{center}
  \includegraphics[width=10.5cm]{figs/htmlTree.png}
\end{center}

\begin{flushright}
{\tiny
Source: http://khan4019.github.io/HighPerformanceJSandCSS/images/htmlTree.png
}
\end{flushright}

\end{frame}

\begin{frame}
\frametitle{Documentos XML bien formados y válidos}

Hay dos niveles de corrección en XML:

\begin{itemize}
\item Un documento bien formado es conforme con la sintaxis XML.
\item Un documento válido además es conforme con una semántica XML (definida en un XML Schema, generalmente una DTD).
\end{itemize}

\end{frame}



\begin{frame}[fragile]
\frametitle{Sintaxis XML (I)}

\begin{itemize}
\item El único requisito indispensable para un documento sintácticamente bien formado en XML es la existencia de un elemento raíz.
\item La sintaxis básica para un elemento es:
\begin{footnotesize}
\begin{verbatim}
<element_name attribute_name="attribute_value">
  Element Content
</element_name>
\end{verbatim}
\end{footnotesize}
\item Un documento XML genérico contiene una estructura de datos en forma de árbol.
\item Los elementos han de estar debidamente anidados. En caso contrario, no estaría bien formado.
\item Sintaxis especial para elementos sin contenido: $<br/>$

\end{itemize}

\end{frame}



\begin{frame}[fragile]
\frametitle{Sintaxis XML (y II)}

\begin{itemize}
\item Una entidad en XML es una estructura de datos, generalmente texto, con nombre.
\item Pueden ser utilizadas para caracteres difíciles de introducir por teclado.
\item Otras veces son simplemente atajos para palabras comunes.
\item Ejemplos: \&amp;, \&lt;, \&gt;, \&quote;, \&aacute;...
\end{itemize}

\begin{footnotesize}
\begin{verbatim}
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE example [
  <!ENTITY copy "&#xA9;">
  <!ENTITY copyright-notice "Copyright &copy; 2006, XYZ Enterprises">
]>
<example>
    &copyright-notice;
</example>
\end{verbatim}
\end{footnotesize}

\end{frame}


\begin{frame}
\frametitle{Keep calm....}

\begin{center}
  \includegraphics[width=6.5cm]{figs/characterreferences.jpg}
\end{center}

\begin{flushright}
{\tiny
Source: http://rlv.zcache.com/i\_amp\_x2665\_xml\_button-re92eeafd28524d3ea51e08c4c49765c5\_x7j3i\_8byvr\_512.jpg
}
\end{flushright}

\end{frame}


\begin{frame}
\frametitle{Semántica XML}

\begin{itemize}
\item XML no define los nombres, la jerarquía ni el significado de los elementos ni atributos.
\item Éstos se pueden definir en un esquema configurable o DTD.
\item De esta manera, XML provee la sintaxis para la creación de lenguajes de marcado de propósito específico.
\item Los esquemas complementan las reglas sintácticas con una serie de limitaciones semánticas.
\item Así, definen los nombres de los elementos, su jerarquía y sus atributos.
\end{itemize}

\end{frame}


\begin{frame}[fragile]
\frametitle{Ejercicio: Crear un DTD}

Crea un DTD para una agenda:

\begin{itemize}
\item Nombre (obligatorio)
\item Cumpleaños
\item Sexo
\item Teléfono
\end{itemize}

\end{frame}



\begin{frame}[fragile]
\frametitle{Document Type Definition (DTD)}

Ejemplo de solución:

\begin{footnotesize}
\begin{verbatim}
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE mi_agenda SYSTEM "agenda.dtd">
<!ELEMENT people_list (person*)>
<!ELEMENT person (name, birthdate?, gender?, phone?)>
<!ELEMENT name (#PCDATA)>
<!ELEMENT birthdate (#PCDATA)>
<!ELEMENT gender (#PCDATA)>
<!ELEMENT phone (#PCDATA)>
\end{verbatim}
\end{footnotesize}


\begin{itemize}
\item Crear un esquema con DTD es antiguo (XSD es más moderno), pero sencillo.
\item DTD no soporta espacios de nombres (\emph{namespaces}).
\end{itemize}


\end{frame}



\begin{frame}[fragile]
\frametitle{XML Schema Definition (XSD)}

\begin{footnotesize}
\begin{verbatim}
<?xml version="1.0" encoding="utf-8" ?>
<xs:schema elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
 <xs:element name="Person">
  <xs:complexType>
   <xs:sequence>
    <xs:element name="Name" type="xs:string" />
    <xs:element name="Birthdate" type="xs:string" />
    <xs:element name="Gender" type="xs:string" />
     <xs:simpleType>
      <xs:restriction base="xs:string">
       <xs:enumeration value="male" />
       <xs:enumeration value="female" />
      </xs:restriction>
     </xs:simpleType>
    <xs:element name="Phone" type="xs:string" />
    </xs:element>
   </xs:sequence>
  </xs:complexType>
 </xs:element>
</xs:schema>
\end{verbatim}
\end{footnotesize}

\end{frame}


\section{SMIL}

\begin{frame}
\frametitle{Synchronized Multimedia Integration Language (SMIL)}
\begin{itemize}
\item Es un lenguaje, basado en XML, para presentaciones con contenidos multimedia interactivos.
\item Tipicamente se integran:
  \begin{itemize}
  \item audio/video
  \item streaming de audio/video
  \item imágenes
  \item texto
  \item otros medios
  \end{itemize}
\end{itemize}

\end{frame}



\begin{frame}
\frametitle{Objetivos de SMIL}

\begin{itemize}
\item Permitir a los autores especificar cuándo se muestran qué cosas.
\item Proporciona mecanismos de sincronización para hacer coincidir, por ejemplo, una cierta frase hablada con la aparicion de un cierto elemento gráfico.
\item Idea básica: nombrar los medios que componen la presentación (texto, imagenes, audio, vídeo) mediante URLs, y planificar su presentación en paralelo o en secuencia (y combinaciones).
\end{itemize}

\end{frame}



\begin{frame}
\frametitle{Características principales de SMIL}

\begin{itemize}
\item Una presentación esta compuesta por componentes accesibles vía URLs.
\item Los componentes pueden ser de diferentes medios.
\item Pueden mostrarse unos u otros medios en función de preferencias del usuario, o de características de su cliente y de su conexión.
\item Los instantes de comienzo y finalización de los diferentes componentes se especifican como absolutos o relativos a eventos en otros componentes de otros medios. Ej.: Se muestra una nueva transparencia cuando el narrador empieza a hablar sobre ella.
\end{itemize}

\end{frame}



\begin{frame}
\frametitle{Más cosas de SMIL}

\begin{itemize}
\item La etiqueta seq muestra eventos secuencialmente.
\item La etiqueta par permite eventos en paralelo.
\item La etiqueta switch permite alternativas.
\end{itemize}

\end{frame}

\begin{frame}
\frametitle{Keep calm....}

\begin{center}
  \includegraphics[width=6.0cm]{figs/keep-calm-and-keep-smil-in.png}
\end{center}

\begin{flushright}
{\tiny
Source: http://sd.keepcalm-o-matic.co.uk/i/keep-calm-and-keep-smil-in.png
}
\end{flushright}

\end{frame}




\section{Procesando XML}

\begin{frame}[fragile]
\frametitle{Procesando XML}

\begin{footnotesize}
\begin{verbatim}

<humor>
 <chiste calificacion="malo">
  <pregunta>papapapapaco. ¿Eres tartamudo?.</pregunta>
  <respuesta>
     Yo no, mi padre. Y el del Registro Civil, un mamoncete.
  </respuesta>
 </chiste>
 <chiste calificacion="malisimo">
  <pregunta>Papá, ¿por qué te casaste con mamá?</pregunta>
  <respuesta>Ahhhh... ¡tú tampoco te lo explicas!</respuesta>
 </chiste>
</humor>
\end{verbatim}
\end{footnotesize}

\end{frame}


\begin{frame}
\frametitle{¿Cómo procesar XML?}

Hay varias maneras de procesar un documento XML:

\begin{itemize}
\item Mediante \emph{slices}
\item Mediante expresiones regulares
\item Mediante APIs
\end{itemize}

\end{frame}

\begin{frame}
\frametitle{SAX y DOM}

Simple API for XML (SAX)

\begin{itemize}
\item SAX es una interfaz léxica, dirigida por eventos.
\item El documento se lee linealmente y mediante el uso de \emph{callbacks}
a métodos de un manejador.
\item Ventajas: sencillo, poca memoria.
\item Desventajas: difícil extraer información aleatoriamente.
\end{itemize}

Document Object Model (DOM)

\begin{itemize}
\item DOM es una API que permite la navegación de todo el documento como si fuera una árbol de objetos.
\item Ventaja: fácil extracción de información.
\item Desventaja: necesita mucha memoria si el documento es grande.
\end{itemize}


\end{frame}


\begin{frame}
\frametitle{SAX: Una API orientada a eventos (I)}

\begin{center}
  \includegraphics[width=4.5cm]{figs/saxparser.jpg}
\end{center}

\begin{flushright}
{\tiny
Source: http://www.simonstl.com/articles/regfrag/figs/regfragpics/saxparser.jpg
}
\end{flushright}

\end{frame}


\begin{frame}
\frametitle{SAX: Una API orientada a eventos (y II)}

\begin{center}
  \includegraphics[width=8.5cm]{figs/sax.jpg}
\end{center}

\begin{flushright}
{\tiny
Source: http://wiki.scn.sap.com/wiki/download/attachments/78053807/sax1.JPG
}
\end{flushright}

\end{frame}

\begin{frame}[fragile]
\frametitle{SAX en Python: Un ejemplo (I)}

\begin{footnotesize}
\begin{verbatim}
class ChistesHandler(ContentHandler):
  def __init__ (self):
    self.calificacion = ""
    self.pregunta = ""
    self.inPregunta = 0
    self.respuesta = ""
    self.inRespuesta = 0

  def startElement(self, name, attrs):
    if name == 'chiste':
      self.calificacion = attrs.get('calificacion',"")
    elif name == 'pregunta':
      self.inPregunta = 1
    elif name == 'respuesta':
      self.inRespuesta = 1
\end{verbatim}
\end{footnotesize}

\end{frame}

\begin{frame}[fragile]
\frametitle{SAX en Python: Un ejemplo (II)}

\begin{footnotesize}
\begin{verbatim}

  def endElement(self, name):
    if name == 'pregunta':
      print self.pregunta
      self.pregunta = ""
      self.inPregunta = 0
    if name == 'respuesta':
      self.respuesta = ""
      self.inRespuesta = 0

  def characters(self, char):
    if self.inPregunta:
      self.pregunta = self.pregunta + char
    if self.inRespuesta:
      self.respuesta += char

\end{verbatim}
\end{footnotesize}

\end{frame}


\begin{frame}[fragile]
\frametitle{SAX en Python: Un ejemplo (III)}

\begin{footnotesize}
\begin{verbatim}
#!/usr/bin/python                 
from xml.sax import make_parser
from xml.sax.handler import ContentHandler

# [clase ChistesHandler]

parser = make_parser()
cHandler = ChistesHandler()
parser.setContentHandler(cHandler)
parser.parse(open('chistes.xml'))

\end{verbatim}
\end{footnotesize}

\end{frame}


\begin{frame}
\frametitle{Saca tu lado friki}

\begin{center}
  \includegraphics[width=8.5cm]{figs/businesscard.jpg}
\end{center}

\begin{flushright}
{\tiny
Source: http://2.bp.blogspot.com/-BDE-5-gmCQQ/TzZCoghyrxI/AAAAAAAAHtw/sriOLRZcO40/s640/business\_card.txt-Notepad.jpg
}
\end{flushright}

\end{frame}



\frame{
\maketitle
}

\end{document}
